#!/usr/bin/env ruby

require File.expand_path("../../config/environment", __FILE__)
require "document_republisher"
require "document_repository_observer_mapper"

document_type = ARGV.any? && ARGV.fetch(0)

mapper = DocumentRepositoryObserverMapper.new
repo_listeners = document_type ? mapper.for_types(document_type) : mapper.all

DocumentRepublisher.new(repo_listeners).republish!
