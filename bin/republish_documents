#!/usr/bin/env ruby

require File.expand_path("../../config/environment", __FILE__)
require "document_republisher"
require "document_repository_observer_mapper"

mapper = DocumentRepositoryObserverMapper.new

document_types = ARGV

if document_types.any?
  repo_listeners = mapper.for_types(*document_types)
  puts "Republishing all documents of type: #{document_types.join(", ")}"
else
  repo_listeners = mapper.all
  puts "Republishing __all types__ of documents"
end

DocumentRepublisher.new(repo_listeners).republish!
